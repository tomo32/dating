

<h1>投稿フォーム</h1>
<% if @post_image.errors.any? %>
<%= @post_image.errors.count %>件のエラーが発生しました
<% @post_image.errors.full_messages.each do |message| %>
<%= message %>
<% end %>
<% end %>
<%= form_with model: @post_image, local:true do |f| %>
<h4>画像</h4>
<%= f.file_field :image %>
<div class="form-group row" id="star_photo">
    <%= f.label :photo_rate,'写真映え', class:'col-md-3 col-form-label' %>
    <%= f.hidden_field :photo_rate, id: :review_star %>
  </div>

  <!-- 評価javascript -->
  <script>
  $('#star_photo').raty({
    size     : 36,
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    scoreName: 'post_image[photo_rate]',
    half: true,
  });
  </script>

<div class="form-group row" id="star_price">
    <%= f.label :price_rate,'値段　高い<----->安い', class:'col-md-3 col-form-label' %>
    <%= f.hidden_field :price_rate, id: :review_star %>
  </div>

  <!-- 評価javascript -->
  <script>
  $('#star_price').raty({
    size     : 36,
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    scoreName: 'post_image[price_rate]',
    half: true,
  });
  </script>
<div class="form-group row" id="star">
    <%= f.label :rate,'総合評価 ', class:'col-md-3 col-form-label' %>
    <%= f.hidden_field :rate, id: :review_star %>
  </div>

  <!-- 評価javascript -->
  <script>
  $('#star').raty({
    size     : 36,
    starOff:  '<%= asset_path('star-off.png') %>',
    starOn : '<%= asset_path('star-on.png') %>',
    starHalf: '<%= asset_path('star-half.png') %>',
    scoreName: 'post_image[rate]',
    half: true,
  });
  </script>
<h4>場所</h4>
<%= f.text_field :name %>
<h4>説明</h4>
<%= f.text_area :caption %>
<%= f.label :address %><br />


<%= f.text_field :address %>
<%= f.submit '投稿' %>
<% end %>

<script type="text/javascript">
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(

      function(position){
        const data = {
          latitude: position.coords.latitude,
          longitude: position.coords.longitude,
        };
        $.ajax({
            url: "/post_images/new",
            type: "GET",
            dataType: 'html',
            async: true,
            data,
            success: html => {
              console.log(`response: ${html}`);
            },
            error: (xhr,  textStatus, errorThrown) => {
              console.log('xhr:');
              console.log(xhr);
              console.log(`textStatus: ${textStatus}`);
              console.log(`errorThrown: ${errorThrown}`);
            }
        });
      }
    )
  }
</script>
<%= @latitude %>